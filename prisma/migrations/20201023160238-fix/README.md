# Migration `20201023160238-fix`

This migration has been generated by cipriano98 at 10/23/2020, 1:02:38 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."Gender" AS ENUM ('FEMININO', 'MASCULINO', 'OUTRO')

CREATE TYPE "public"."Role" AS ENUM ('ADMIN', 'CANDIDATE', 'EMPLOYER', 'VACANCYDISTRIBUTOR')

CREATE TABLE "public"."Profile" (
"id" text   NOT NULL ,
"bio" text   ,
"pseudonym" text   ,
"userId" integer   NOT NULL ,
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."User" (
"id" SERIAL,
"authenticationkey" text   NOT NULL ,
"securitykey" text   NOT NULL ,
"fullname" text   NOT NULL ,
"secret" text   ,
"email" text   NOT NULL ,
"cpf" text   NOT NULL ,
"role" "Role"  NOT NULL DEFAULT E'CANDIDATE',
"datebirth" text   ,
"nickname" text   ,
"preferencialname" text   ,
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
"gender" "Gender"  NOT NULL ,
"active" boolean   NOT NULL DEFAULT true,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Address" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"logradouro" text   NOT NULL ,
"bairro" text   NOT NULL ,
"cidade" text   NOT NULL ,
"cep" text   NOT NULL ,
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
"userid" integer   NOT NULL ,
"state" text   DEFAULT E'RS',
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Contact" (
"id" text   NOT NULL ,
"userid" integer   NOT NULL ,
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
"talkto" text   NOT NULL DEFAULT E'me',
"phone" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Curriculum" (
"id" text   NOT NULL ,
"userid" integer   NOT NULL ,
"professionalprofile" text   NOT NULL ,
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Company" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"registrofederal" text   NOT NULL ,
"role" "Role"  NOT NULL DEFAULT E'EMPLOYER',
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
"site" text   ,
"links" text []  ,
"labellinks" text []  ,
"active" boolean   NOT NULL DEFAULT true,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Agency" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"registrofederal" text   NOT NULL ,
"role" "Role"  NOT NULL DEFAULT E'VACANCYDISTRIBUTOR',
"createdat" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedat" timestamp(3)   NOT NULL ,
"site" text   NOT NULL ,
"links" text []  ,
"labellinks" text []  ,
"active" boolean   NOT NULL DEFAULT true,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Profile.userId_unique" ON "public"."Profile"("userId")

CREATE UNIQUE INDEX "User.email_unique" ON "public"."User"("email")

CREATE UNIQUE INDEX "User.cpf_unique" ON "public"."User"("cpf")

CREATE UNIQUE INDEX "User.nickname_unique" ON "public"."User"("nickname")

CREATE UNIQUE INDEX "Curriculum.userid_unique" ON "public"."Curriculum"("userid")

CREATE UNIQUE INDEX "Company.registrofederal_unique" ON "public"."Company"("registrofederal")

CREATE UNIQUE INDEX "Company.site_unique" ON "public"."Company"("site")

CREATE UNIQUE INDEX "Agency.registrofederal_unique" ON "public"."Agency"("registrofederal")

CREATE UNIQUE INDEX "Agency.site_unique" ON "public"."Agency"("site")

ALTER TABLE "public"."Profile" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Address" ADD FOREIGN KEY ("userid")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Contact" ADD FOREIGN KEY ("userid")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Curriculum" ADD FOREIGN KEY ("userid")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201023160238-fix
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,112 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model Profile {
+  id        String   @id @default(uuid())
+  bio       String?
+  pseudonym String?
+  userId    Int      @unique
+  createdat DateTime @default(now())
+  updatedat DateTime @updatedAt
+  User      User     @relation(fields: [userId], references: [id])
+}
+
+model User {
+  id                Int         @id @default(autoincrement())
+  authenticationkey String      @default(uuid())
+  securitykey       String      @default(uuid())
+  fullname          String
+  secret            String?
+  email             String      @unique
+  cpf               String      @unique
+  role              Role        @default(CANDIDATE)
+  datebirth         String?
+  nickname          String?     @unique
+  preferencialname  String?
+  createdat         DateTime    @default(now())
+  updatedat         DateTime    @updatedAt
+  gender            Gender
+  active            Boolean     @default(true)
+  Address           Address[]
+  Contact           Contact[]
+  Curriculum        Curriculum?
+  Profile           Profile?
+}
+
+model Address {
+  id         String   @id @default(uuid())
+  name       String
+  logradouro String
+  bairro     String
+  cidade     String
+  cep        String
+  createdat  DateTime @default(now())
+  updatedat  DateTime @updatedAt
+  userid     Int
+  state      String?  @default("RS")
+  User       User     @relation(fields: [userid], references: [id])
+}
+
+model Contact {
+  id        String   @id @default(uuid())
+  userid    Int
+  createdat DateTime @default(now())
+  updatedat DateTime @updatedAt
+  talkto    String   @default("me")
+  phone     String
+  User      User     @relation(fields: [userid], references: [id])
+}
+
+model Curriculum {
+  id                  String   @id @default(uuid())
+  userid              Int      @unique
+  professionalprofile String
+  createdat           DateTime @default(now())
+  updatedat           DateTime @updatedAt
+  User                User     @relation(fields: [userid], references: [id])
+}
+
+model Company {
+  id              String   @id @default(uuid())
+  name            String
+  registrofederal String   @unique
+  role            Role     @default(EMPLOYER)
+  createdat       DateTime @default(now())
+  updatedat       DateTime @updatedAt
+  site            String?  @unique
+  links           String[]
+  labellinks      String[]
+  active          Boolean  @default(true)
+}
+
+model Agency {
+  id              String   @id @default(uuid())
+  name            String
+  registrofederal String   @unique
+  role            Role     @default(VACANCYDISTRIBUTOR)
+  createdat       DateTime @default(now())
+  updatedat       DateTime @updatedAt
+  site            String   @unique
+  links           String[]
+  labellinks      String[]
+  active          Boolean  @default(true)
+}
+
+enum Gender {
+  FEMININO
+  MASCULINO
+  OUTRO
+}
+
+enum Role {
+  ADMIN
+  CANDIDATE
+  EMPLOYER
+  VACANCYDISTRIBUTOR
+}
```


